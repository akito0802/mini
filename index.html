<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TberScale</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="background"></div>
    <div class="main-container">
      <div class="title">Tber<span class="pink">Scale</span></div>
      <div class="selector-box">
        <select id="key-select">
          <option value="C">C</option>
          <option value="D">D</option>
          <option value="E">E</option>
          <option value="F">F</option>
          <option value="G">G</option>
          <option value="A">A</option>
          <option value="B">B</option>
        </select>

        <select id="scale-type-select">
          <option value="major">major</option>
          <option value="minor">minor</option>
          <option value="church">church</option>
          <option value="jazz">jazz</option>
        </select>

        <select id="scale-select">
          <!-- placeholder, will be populated dynamically -->
        </select>
      </div>

      <div class="fretboard">
        <img id="fretboard-image" src="images/fretboard/C_major_fretboard.png" alt="Fretboard" />
      </div>
    </div>

    <script>
      const keySelect = document.getElementById("key-select");
      const scaleTypeSelect = document.getElementById("scale-type-select");
      const scaleSelect = document.getElementById("scale-select");
      const fretboardImage = document.getElementById("fretboard-image");

      const scaleOptions = {
        major: ["major", "pentatonic", "blues"],
        minor: ["natural_minor", "harmonic_minor", "melodic_minor", "pentatonic", "blues"],
        church: ["ionian", "dorian", "phrygian", "lydian", "mixolydian", "aeolian", "locrian"],
        jazz: ["altered", "whole_tone", "diminished"]
      };

      function populateScaleSelect(type) {
        scaleSelect.innerHTML = "";
        scaleOptions[type].forEach((scale) => {
          const option = document.createElement("option");
          option.value = scale;
          option.textContent = scale;
          scaleSelect.appendChild(option);
        });
      }

      function updateImage() {
        const key = keySelect.value;
        const scale = scaleSelect.value;
        const scaleType = scaleTypeSelect.value;
        let filename = `${key}_${scale}`;
        if (scaleType === "church") filename = `${key}_church_${scale}`;
        else if (scaleType === "jazz") filename = `${key}_jazz_${scale}`;
        fretboardImage.src = `images/fretboard/${filename}_fretboard.png`;
      }

      scaleTypeSelect.addEventListener("change", () => {
        const selectedType = scaleTypeSelect.value;
        populateScaleSelect(selectedType);
        updateImage();
      });

      keySelect.addEventListener("change", updateImage);
      scaleSelect.addEventListener("change", updateImage);

      // 初期設定
      populateScaleSelect(scaleTypeSelect.value);
      updateImage();
    </script>
  </body>
</html>
